å¥½çš„ï¼Œæ‚¨è¿™æ˜¯åœ¨å¯¹ **`libxml2`** é¡¹ç›®çš„æ¼æ´æ³¨å…¥æ¸…å•è¿›è¡Œä»£ç çº§æè¿°ã€‚æˆ‘å°†ç»“åˆæ‚¨æä¾›çš„æ–‡ä»¶ (`parser.c`, `tree.c`, `error.c`)ï¼Œä¸ºæ‚¨æä¾›æ¯ä¸ªæ¼æ´çš„ **è¯¦ç»†ä»£ç ä¸Šä¸‹æ–‡** å’Œ **é£é™©æè¿°**ã€‚

---

# ğŸ“ libxml2 æ¼æ´æ³¨å…¥æ€»ç»“ (ä»£ç çº§æè¿°)

## æ¼æ´æ€»è§ˆè¡¨ (Ground Truth)

| æ¼æ´ç¼–å· | æ¼æ´ç±»å‹ | ç›®æ ‡ Fuzzer | ä¿®æ”¹æ–‡ä»¶ | å‡½æ•°å | è§¦å‘æœºåˆ¶ |
| :--- | :--- | :--- | :--- | :--- | :--- |
| **#1** | Stack Buffer Overflow | `xml_fuzzer` | `parser.c` | `xmlParseName` | è¶…é•¿ XML æ ‡ç­¾å |
| **#2** | Double Free | `xml_fuzzer` | `tree.c` | `xmlFreeNode` | èŠ‚ç‚¹æ¸…ç†æ—¶é‡å¤ free |
| **#3** | Use-After-Free (Read) | `xml_fuzzer` | `tree.c` | `xmlUnlinkNode` | è§£é“¾åè®¿é—®å·²åˆ é™¤èŠ‚ç‚¹çš„æŒ‡é’ˆ |
| **#4** | Null Pointer Deref | `xml_fuzzer` | `tree.c` | `xmlAddChild` | ç§»é™¤ `parent` åˆ¤ç©ºæ£€æŸ¥ |
| **#5** | Format String | `xml_fuzzer` | `error.c` | `xmlGenericError` | é”™è¯¯åœ°ä½¿ç”¨ä¸å¯æ§å˜é‡ä½œä¸ºæ ¼å¼åŒ–å­—ç¬¦ä¸² |

---

## æ¼æ´è¯¦æƒ…ï¼ˆåŸºäº `libxml2` æºä»£ç ï¼‰

### 1. Sim-CVE-#1ï¼šStack Buffer Overflow (æ ˆç¼“å†²åŒºæº¢å‡º)

* [cite_start]**ä¿®æ”¹æ–‡ä»¶:** `parser.c` [cite: 1]
* [cite_start]**æ³¨å…¥å‡½æ•°:** `xmlParseName` [cite: 1]
* **æ¼æ´æè¿°:** Fuzzer æ„é€ è¶…é•¿çš„ XML æ ‡ç­¾åï¼Œè§¦å‘å‡½æ•°å†…ä¸å®‰å…¨çš„ `sprintf` è¯­å¥ï¼Œå¯¼è‡´æ ˆä¸Šå±€éƒ¨å˜é‡æº¢å‡ºã€‚è¿™ä¸æ‚¨åœ¨å®é™…è¿è¡Œä¸­è§‚å¯Ÿåˆ°çš„å´©æºƒç°è±¡å®Œå…¨ä¸€è‡´ã€‚

| ä»£ç ä¸Šä¸‹æ–‡ | æè¿° |
| :--- | :--- |
| `parser.c` çº¦ 3309-3312 è¡Œ | [cite_start]ä½äº `xmlParseName` å‡½æ•°å†…éƒ¨ï¼Œé’ˆå¯¹è¶…é•¿è¾“å…¥ï¼Œæ³¨å…¥äº†ä½¿ç”¨ `sprintf` å†™å…¥ 16 å­—èŠ‚æ ˆç¼“å†²åŒº (`debug_buf`) çš„é€»è¾‘ã€‚ [cite: 1] |
| å®é™…å´©æºƒè¡Œ | [cite_start]`parser.c:3312:9` (å¯¹åº” `sprintf` è¯­å¥) [cite: 1] |
| é£é™© | Stack Buffer Overflowï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒå’Œæ ˆç ´åã€‚ |

### 2. Sim-CVE-#2ï¼šDouble Free (åŒé‡é‡Šæ”¾)

* [cite_start]**ä¿®æ”¹æ–‡ä»¶:** `tree.c` [cite: 2]
* [cite_start]**æ³¨å…¥å‡½æ•°:** `xmlFreeNode` [cite: 2]
* **æ¼æ´æè¿°:** åœ¨é‡Šæ”¾ XML èŠ‚ç‚¹ç»“æ„æ—¶ï¼Œé‡å¤è°ƒç”¨äº† `xmlFree` (æˆ– `free`) é‡Šæ”¾åŒä¸€æŒ‡é’ˆã€‚

| ä»£ç ç‰‡æ®µ | æè¿° |
| :--- | :--- |
| ä½äº `xmlFreeNode` å‡½æ•°å†…éƒ¨ | [cite_start]æ³¨å…¥äº†å¯¹åŒä¸€æŒ‡é’ˆï¼ˆå¦‚ `node->content` æˆ– `node->name`ï¼‰çš„é‡å¤é‡Šæ”¾ã€‚ [cite: 2] |
| è§¦å‘æœºåˆ¶ | Fuzzer éœ€è¦æ„é€ ä¸€ä¸ªèƒ½æˆåŠŸåˆ†é…å¹¶è§¦å‘è¯¥èŠ‚ç‚¹æ¸…ç†è·¯å¾„çš„è¾“å…¥ã€‚ |
| é£é™© | Double Freeï¼Œå¯¹å †å†…å­˜ç®¡ç†é€ æˆä¸¥é‡ç ´åï¼Œæ˜¯é«˜å±æ¼æ´ã€‚ |

### 3. Sim-CVE-#3ï¼šUse-After-Free (Read)

* [cite_start]**ä¿®æ”¹æ–‡ä»¶:** `tree.c` [cite: 2]
* [cite_start]**æ³¨å…¥å‡½æ•°:** `xmlUnlinkNode` [cite: 2]
* **æ¼æ´æè¿°:** åœ¨æ‰§è¡ŒèŠ‚ç‚¹è§£é“¾æ“ä½œåï¼Œåº”åœæ­¢ä½¿ç”¨è¯¥èŠ‚ç‚¹æŒ‡é’ˆï¼Œä½†æ³¨å…¥ä»£ç åœ¨å†…å­˜é‡Šæ”¾åä»å°è¯•è¯»å–è¯¥èŠ‚ç‚¹çš„å±æ€§ã€‚

| ä»£ç ç‰‡æ®µ | æè¿° |
| :--- | :--- |
| ä½äº `xmlUnlinkNode` å‡½æ•°å†…éƒ¨ | [cite_start]æ³¨å…¥é€»è¾‘åœ¨èŠ‚ç‚¹è¢«é€»è¾‘è§£é“¾å¹¶æ ‡è®°ä¸ºé‡Šæ”¾åï¼Œå°è¯•é€šè¿‡åŸå§‹æŒ‡é’ˆè¯»å–èŠ‚ç‚¹å±æ€§ï¼ˆå¦‚ `node->parent` çš„å€¼ï¼‰ã€‚ [cite: 2] |
| é£é™© | Use-After-Free (Read)ï¼Œå¯èƒ½å¯¼è‡´ç¨‹åºå´©æºƒæˆ–æ³„éœ²æ—§å†…å­˜æ•°æ®ã€‚ |

### 4. Sim-CVE-#4ï¼šNull Pointer Deref (ç©ºæŒ‡é’ˆè§£å¼•ç”¨)

* [cite_start]**ä¿®æ”¹æ–‡ä»¶:** `tree.c` [cite: 2]
* [cite_start]**æ³¨å…¥å‡½æ•°:** `xmlAddChild` [cite: 2]
* **æ¼æ´æè¿°:** ç§»é™¤äº†å‡½æ•°å…¥å£å¤„çš„ç©ºæŒ‡é’ˆæ£€æŸ¥ï¼Œå¯¼è‡´å½“ `parent` å‚æ•°ä¸º `NULL` æ—¶ï¼Œç¨‹åºå¼ºåˆ¶è®¿é—®å…¶æˆå‘˜ã€‚

| ä»£ç ç‰‡æ®µ | æè¿° |
| :--- | :--- |
| ä½äº `xmlAddChild` å‡½æ•°çš„èµ·å§‹å¤„ | [cite_start]åŸæœ‰ä»£ç ä¸­ï¼Œç”¨äºæ£€æŸ¥ `parent` æ˜¯å¦ä¸º `NULL` çš„è¯­å¥è¢«ç§»é™¤æˆ–ç»•è¿‡ã€‚ [cite: 2] |
| å´©æºƒç‚¹ | [cite_start]`xmlAddChild` å†…éƒ¨å¯¹ `parent` æˆå‘˜çš„é¦–æ¬¡è®¿é—®ã€‚ [cite: 2] |
| é£é™© | Null Pointer Dereferenceï¼Œå¯¼è‡´ç¨‹åºå´©æºƒ (SEGV)ã€‚ |

### 5. Sim-CVE-#5ï¼šFormat String (æ ¼å¼åŒ–å­—ç¬¦ä¸²æ¼æ´)

* [cite_start]**ä¿®æ”¹æ–‡ä»¶:** `error.c` [cite: 3]
* [cite_start]**æ³¨å…¥å‡½æ•°:** `xmlGenericError` (æˆ–å…¶è°ƒç”¨è·¯å¾„) [cite: 3]
* **æ¼æ´æè¿°:** åœ¨é”™è¯¯å¤„ç†å‡½æ•°ä¸­ï¼Œé”™è¯¯åœ°å°†ä¸€ä¸ªä¸å¯æ§çš„å˜é‡ç›´æ¥ä½œä¸º `printf` çš„æ ¼å¼åŒ–å‚æ•°ï¼Œå¦‚æœè¾“å…¥åŒ…å« `%s`, `%x` ç­‰æ ¼å¼ç¬¦ï¼Œå¯èƒ½è¢«åˆ©ç”¨ã€‚

| ä»£ç ç‰‡æ®µ | æè¿° |
| :--- | :--- |
| ä½äº `xmlGenericError` å‡½æ•°å†…éƒ¨ | [cite_start]æ³¨å…¥äº†ç±»ä¼¼ `fprintf(stderr, buffer);` çš„è¯­å¥ï¼Œå…¶ä¸­ `buffer` åŒ…å«äº†æ¥è‡ª Fuzzer è¾“å…¥çš„ä¸å¯ä¿¡æ•°æ®ã€‚ [cite: 3] |
| é£é™© | Format String Vulnerabilityï¼Œå¯èƒ½è¢«ç”¨äºè¯»å–æ ˆä¸Šå†…å­˜ (ä¿¡æ¯æ³„éœ²) æˆ–å¯¼è‡´ç¨‹åºå´©æºƒã€‚ |
